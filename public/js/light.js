// Generated by CoffeeScript 1.6.3
(function() {
  var actuate, add_values, client, get_tile;

  actuate = function(dest, key) {
    return console.log(dest + " " + key);
  };

  get_tile = function(dest, key, value) {
    var str;
    str = "<div class='tiles'><div class='small tile'>";
    str += "<i class='icon-" + key + "' onclick='";
    return str += "actuate(\"" + dest + "\", \"" + key + "\");'></i></div></div>";
  };

  add_values = function(msg) {
    var k, v, _ref, _results;
    $("#content").append(msg.destinationName);
    _ref = $.parseJSON(msg.payloadString);
    _results = [];
    for (k in _ref) {
      v = _ref[k];
      _results.push($("#content").append(get_tile(msg.destinationName, k, v)));
    }
    return _results;
  };

  client = new Messaging.Client("127.0.0.1", 8080, "clientId");

  client.onConnectionLost = function(response) {
    return console.log(response);
  };

  client.onMessageArrived = function(message) {
    if (/\/values/.test(message.destinationName)) {
      return add_values(message);
    }
  };

  client.connect({
    onSuccess: function() {
      var message;
      client.subscribe("/home/actuators/#");
      message = new Messaging.Message("list");
      message.destinationName = "/home/actuators";
      return client.send(message);
    },
    onFailure: function(e) {
      return console.log(e);
    }
  });

}).call(this);
